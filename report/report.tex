\documentclass[a4paper]{article}

% HEADER
\input{header_report.tex}


\begin{document}

% ==================================================================================================================================
% TITLEPAGE 

\input{titlepage_report.tex}

\tableofcontents

\noindent\rule{\textwidth}{1pt}

% ==================================================================================================================================
% Introduction 

\section*{Introduction}

% ==================================================================================================================================
% La fission nucléaire

\newpage 
\section{La fission nucléaire : De la théorie à la pratique}

Avant d'introduire et de modéliser un réacteur nucléaire, commençons par nous pencher sur ses mécanismes 
internes pour comprendre leur fonctionnement. 

\subsection{Un peu de chimie}

Au niveau microscopique, la matière est constituée de molécules, elles même composées d'un 
agencement de plusieurs atomes respectant un certaine position. 
La concept de molécules fut introduit en 1811\textsuperscript{\parencite{molecules-wiki}} par 
Amedeo Avogadro. Ces éléments sont au coeur de l'ensembles des réactions chimiques usuelles telles que 
la combustion, le fonctionnement des piles/batteries ou même la rouille.
Cependant, certaines transformations mettent en jeu non plus les molécules, mais les noyaux des atomes eux-mêmes. 
Ces réactions, dites nucléaires (voir \cite{reaction-nucleaire-wiki}), libèrent des quantités d’énergie bien supérieures aux réactions chimiques.

La notion d'atome est aussi ancienne que celle des molécules mais son modèle actuel nous vient 
de Schrödinger\textsuperscript{\parencite{atomes-wiki}} et date de 1926. 

\subsection{La fission} 

Il existe deux types de réactions nucléaires : la \emph{fission} et la \emph{fusion}. 
La fission nucléaire\textsuperscript{\parencite{fission-wiki}} fut découverte en 1938 par des physiciens allemands sur le travail de Enrico Fermi datant des années 
1934. Cette découverte fait l'effet d'une bombe (sans mauvais jeu de mots) dans le milieu de la physique moderne et lance 
aussitôt la course au développement de l'arme atomique dans un contexte tendu de fin seconde guerre mondiale et 
de début de guerre froide. 

Le principe de la fission nucléaire est assez simple. Partant d'un noyau lourd instable (souvent un isotope 
d'uranium ou de plutonium) et en le bombardant de neutrons à très grande vitesse on souhaite séparer le 
noyau en deux parties approximativement égales d'éléments moins lourds. 
Lors de cette séparation, des neutrons sont libérés et peuvent, eux aussi, produire de nouvelles réactions de fission 
avec d'autres atomes lourds. C'est ce que l'on appelle le principe de \emph{réaction en chaîne}. 

Une telle réaction produit énormément d'énergie et de chaleur, à titre d'exemple, la combustion de 1kg de charbon
produit $3 \times 10^7$ J alors la fission de 1kg d'uranium en produit $ 8 \times 10^{13}$ soit entre 
100 millions et 1 milliard de fois plus d'énergie libérée. 

Ce surplus d'énergie permet actuellement de produire de l'électricité dans nos centrales nucléaires. La chaleur 
produite vaporise de l'eau qui fait ensuite tourner des turbines pour produire de l'électricité. 

\subsection{Différents types de neutrons}\label{subsec:neutron-type}

Pour induire une réaction en chaîne dans un réacteur et la maintenir, il faut jouer avec différents paramètres tels que 
la densité du matériaux fissile, la quantité de neutrons introduite au départ, la forme du réacteur, sa température, etc... 
Nous essaierons d'introduire tout ces paramètres dans notre modèle pour le rendre le plus proche du réel possible. 

Dans cet objectif, nous ne pouvons pas négliger le fait que plusieurs types de neutrons existent dans ce type de réactions. 
En effet, ceux-ci possèdent une certaine quantité d'énergie et se déplacent à une certaine vitesse qui n'est pas toujours constante. 
Ainsi, pour pouvoir induire une réaction de fission, un neutron doit être suffisament ralenti pour percuter un atome lourd. 
Nous différencierons donc 3 types de neutrons : 
\begin{itemize}
    \item Les neutrons \textbf{rapides} : produits directement par une réaction de fission, ils possèdent beaucoup 
    d'énergie, se déplacent vite et ont une très faible probabilité d'être absorbés par le milieu. 
    \item Les neutrons \textbf{épithermiques} : ce sont des neutrons en ralentissement dans le milieu possédant une 
    énergie plus faible. Ils ont plus d'interractions avec le milieu. 
    \item Les neutrons \textbf{thermiques} : ce sont des neutrons complètement ralentis qui se déplacent à la même vitesse 
    que les isotopes lourds. Ils peuvent donc plus facilement induire des réactions de fission. Ils servent 
    à maintenir une réaction en chaîne dans le réacteur. 
\end{itemize}

\begin{table}[H]
    \centering
    \begin{adjustbox}{max width=\textwidth}
        \begin{tabular}{@{}>{\RaggedRight\arraybackslash}p{3cm}
                            >{\RaggedRight\arraybackslash}p{3.5cm}
                            >{\RaggedRight\arraybackslash}p{4cm}
                            >{\RaggedRight\arraybackslash}p{4cm}@{}}
            \toprule
            \textbf{Type de neutron} & \textbf{Plage d'énergie typique} & \textbf{Rôle dans le réacteur} & \textbf{Comportement} \\ 
            \midrule
            \textbf{Rapide} & $\sim$2\,MeV & Produit directement par la fission & Subit des collisions pour se ralentir (modération) \\
            \textbf{Épithermique} & 1\,eV – 1\,keV & Phase intermédiaire du ralentissement & Perd progressivement son énergie cinétique \\
            \textbf{Thermique} & $\sim$0.025\,eV & Provoque efficacement la fission de l'U-235 & Absorbé par les noyaux fissiles \\ 
            \bottomrule
        \end{tabular}
    \end{adjustbox}
    \caption{Principaux types de neutrons intervenant dans un réacteur nucléaire}
    \label{tab:types_neutrons}
\end{table}

\subsection{Le rôle du modérateur}

On souhaiterai entretenir une réaction en chaîne dans un réacteur tout en évitant qu'elle s'emballe, nous donc devons 
introduire un \emph{modérateur}. 
Son rôle sera de ralentir les neutrons nouvellement créés par fission tout en en absorbant une certaine quantité pour ne 
pas que la réaction s'emballe. Un modérateur doit donc être assez léger tout en ralentissant suffisament les neutrons. 
En pratique, différents matériaux sont utilisés, les voici dans le tableau suivant : 

\begin{table}[H]
    \centering
    \begin{adjustbox}{max width=\textwidth}
        \begin{tabular}{@{}>{\RaggedRight\arraybackslash}p{3.2cm}
                            >{\RaggedRight\arraybackslash}p{3.2cm}
                            >{\RaggedRight\arraybackslash}p{3cm}
                            >{\RaggedRight\arraybackslash}p{3cm}
                            >{\RaggedRight\arraybackslash}p{3cm}@{}}
            \toprule
            \textbf{Modérateur} & \textbf{Composition chimique} & \textbf{Pouvoir modérateur} & \textbf{Absorption neutronique} & \textbf{Utilisation typique} \\ 
            \midrule
            \textbf{Eau légère (H$_2$O)} & Hydrogène et oxygène & Excellent & Moyenne & Réacteurs à eau pressurisée (REP) \\
            \textbf{Eau lourde (D$_2$O)} & Deutérium et oxygène & Excellent & Très faible & Réacteurs CANDU (Canada) \\
            \textbf{Graphite (C)} & Carbone pur & Bon & Très faible & Réacteurs RBMK et AGR \\
            \textbf{Béryllium (Be)} & Béryllium pur & Bon & Faible & Réacteurs de recherche \\ 
            \bottomrule
        \end{tabular}
    \end{adjustbox}
    \caption{Caractéristiques comparées des principaux matériaux modérateurs}
    \label{tab:moderateurs}
\end{table}

% \subsection{La section efficace}

% Pour modéliser correctement les interactions entre les neutrons et la matière, il est nécessaire d’introduire la notion de 
% \emph{section efficace}. Celle-ci traduit la probabilité qu’un neutron interagisse avec un noyau lorsqu’il le rencontre. 
% En d'autres termes, elle représente une surface fictive caractérisant la capacité d’un noyau à provoquer une réaction 
% (nucléaire ou non) lorsqu’il est bombardé par des neutrons.

% La section efficace, notée $\sigma$, s’exprime en \emph{barn} :
%     \[ 1\,\text{barn} = 10^{-28}\,\text{m}^2 \]
% Plus la valeur de $\sigma$ est grande, plus la probabilité d’interaction est élevée. Elle dépend à la fois :
% \begin{itemize}
%     \item de la nature du noyau cible (Uranium, Plutonium, etc.),
%     \item du type d’interaction considérée (diffusion, capture, fission),
%     \item et surtout de l’énergie du neutron incident.
% \end{itemize}

% La figure suivante illustre typiquement la variation de la section efficace de fission en fonction de l’énergie du neutron : 
% elle est très faible pour les neutrons rapides, et augmente considérablement lorsque les neutrons deviennent thermiques. 
% C’est cette dépendance énergétique qui rend le rôle du modérateur essentiel dans les réacteurs à neutrons thermiques.

% \begin{figure}[H]
%     \centering
%     \includegraphics[scale=0.25]{images/section_efficace.png}
%     \caption{Évolution typique de la section efficace de fission en fonction de l’énergie du neutron}
%     \label{fig:section_efficace}
% \end{figure}

% On distingue généralement plusieurs types de sections efficaces :
% \begin{itemize}
%     \item $\sigma_f$ : \textbf{section efficace de fission}, probabilité qu’un neutron provoque une fission,
%     \item $\sigma_c$ : \textbf{section efficace de capture}, probabilité qu’un neutron soit absorbé sans fission,
%     \item $\sigma_s$ : \textbf{section efficace de diffusion}, probabilité qu’un neutron soit simplement dévié.
% \end{itemize}

% Leur somme constitue la \emph{section efficace totale} :
%     \[ \sigma_t = \sigma_f + \sigma_c + \sigma_s \]

% Pour illustrer ces valeurs, le tableau suivant compare les sections efficaces de différents isotopes couramment utilisés 
% dans les réacteurs nucléaires pour des neutrons thermiques :

% \begin{table}[H]
%     \centering
%     \begin{adjustbox}{max width=\textwidth}
%         \begin{tabular}{@{}>{\RaggedRight\arraybackslash}p{3cm}
%                             >{\RaggedRight\arraybackslash}p{3.5cm}
%                             >{\RaggedRight\arraybackslash}p{3.5cm}
%                             >{\RaggedRight\arraybackslash}p{3.5cm}@{}}
%             \toprule
%             \textbf{Isotope} & \textbf{Section efficace de fission ($\sigma_f$)} & \textbf{Section efficace de capture ($\sigma_c$)} & \textbf{Remarques} \\ 
%             \midrule
%             \textbf{Uranium-235} & $\sim$580 barns & $\sim$100 barns & Très réactif aux neutrons thermiques \\ 
%             \textbf{Uranium-238} & $\sim$0.02 barns & $\sim$2.7 barns & Ne fissionne qu’avec des neutrons rapides \\ 
%             \textbf{Plutonium-239} & $\sim$750 barns & $\sim$270 barns & Fortement fissile, produit secondaire du cycle U-238 \\ 
%             \bottomrule
%         \end{tabular}
%     \end{adjustbox}
%     \caption{Comparaison des sections efficaces pour différents isotopes fissiles}
%     \label{tab:sections_efficaces}
% \end{table}

% Ainsi, la grande différence de section efficace entre l’uranium-235 et l’uranium-238 explique pourquoi seul le premier 
% est utilisé comme combustible principal dans les réacteurs à neutrons thermiques. 
% La compréhension et la maîtrise de cette grandeur sont donc essentielles pour modéliser la probabilité d’absorption, 
% de diffusion et de fission dans un réacteur.

\subsection{Le facteur de multiplication \( k \)}

Le \emph{facteur de multiplication} \( k \) est une grandeur fondamentale dans l’étude des réacteurs nucléaires.  
Il caractérise l’évolution de la population de neutrons d’une génération à la suivante et permet de déterminer 
si la réaction en chaîne s’amplifie, se stabilise ou s’éteint.  

On définit \( k \) comme le rapport entre le nombre moyen de neutrons produits par fission à une génération \( n+1 \) 
et le nombre de neutrons présents à la génération \( n \) :
    \begin{equation}
        k = \frac{\text{Nombre de neutrons à la génération } (n+1)}{\text{Nombre de neutrons à la génération } n}
    \end{equation}
Ce facteur dépend directement de la composition du combustible, du taux d’absorption, du pouvoir modérateur et de la géométrie du réacteur.  
\begin{itemize}
    \item Si \( k < 1 \) : chaque génération produit moins de neutrons que la précédente, la réaction en chaîne finit par s’éteindre.  
    \item Si \( k = 1 \) : la population de neutrons reste constante — le réacteur est dit \emph{critique}.  
    \item Si \( k > 1 \) : la population augmente de génération en génération — le réacteur devient \emph{sur-critique}, 
    conduisant potentiellement à une réaction incontrôlée si aucune régulation n’est effectuée.  
\end{itemize}

\begin{table}[H]
    \centering
    \begin{adjustbox}{max width=\textwidth}
        \begin{tabular}{@{}>{\RaggedRight\arraybackslash}p{3.5cm}
                            >{\RaggedRight\arraybackslash}p{4cm}
                            >{\RaggedRight\arraybackslash}p{6cm}@{}}
            \toprule
            \textbf{Régime du réacteur} & \textbf{Valeur du facteur \( k \)} & \textbf{Conséquence physique} \\ 
            \midrule
            \textbf{Sous-critique} & \( k < 1 \) & La réaction en chaîne s’éteint progressivement (extinction). \\ 
            \textbf{Critique} & \( k = 1 \) & La réaction est stable : la puissance du réacteur est constante. \\ 
            \textbf{Sur-critique} & \( k > 1 \) & La réaction s’emballe : augmentation exponentielle du nombre de neutrons. \\ 
            \bottomrule
        \end{tabular}
    \end{adjustbox}
    \caption{Différents régimes du réacteur selon la valeur du facteur de multiplication \( k \)}
    \label{tab:facteur_k}
\end{table}
 
% En pratique, on décompose le facteur de multiplication en plusieurs composantes physiques :
%     \begin{equation}
%         k = \eta \, f \, p \, \varepsilon,
%     \end{equation}
% où :
% \begin{itemize}
%     \item \( \eta \) : nombre moyen de neutrons produits par fission et disponibles pour entretenir la réaction,  
%     \item \( f \) : fraction des neutrons absorbés dans le combustible fissile,  
%     \item \( p \) : probabilité qu’un neutron échappe à la résonance d’absorption pendant son ralentissement,  
%     \item \( \varepsilon \) : facteur de multiplication rapide (neutrons produits par fissions induites par des neutrons rapides).  
% \end{itemize}

% Le contrôle du facteur \( k \) est au cœur de la sûreté des réacteurs.  
% Il est ajusté à l’aide de barres de contrôle et du réglage 
% du modérateur, afin de maintenir un équilibre critique stable (\( k = 1 \)) lors du fonctionnement nominal.  


% ==================================================================================================================================
% Modélisation physique

\section{Modélisation Physique}

\subsection{Modèle Global des Barres de Contrôle}

Les barres de contrôle sont le principal mécanisme de pilotage et d'arrêt d'urgence d'un réacteur nucléaire. 
Elles servent à contrôler la population de neutrons et, par conséquent, la puissance thermique du cœur.

\subsubsection{Objectif et principe} 

Leur fonctionnement repose sur l'\textbf{absorption neutronique}. 
Elles sont fabriquées à partir d'éléments dits \textbf{poisons à neutrons}, c'est-à-dire des matériaux ayant
une très haute probabilité d'absorber les neutrons sans provoquer de fission. 
Les matériaux couramment utilisés sont le Bore (B), le Cadmium (Cd), l'Hafnium (Hf) ou le Gadolinium (Gd).
En insérant ces barres dans le cœur du réacteur, on introduit un \textbf{puits} à neutrons :
\begin{itemize}
    \item Les neutrons thermiques entrant en contact avec la barre sont capturés par cette dernière.
    \item La réaction en chaîne ralentit (le facteur de multiplication \(k\) diminue).
    \item Le nombre total de fissions par seconde diminue, ce qui réduit la puissance du réacteur.
\end{itemize}

A l'inverse, en les retirant, on augmente la réactivité et la puissance croît.

\subsubsection{Type et rôle} 

Les barres ne sont pas toutes identiques et ont chacune une vitesse ainsi qu'une amplitude différente :
\begin{itemize}
    \item \emph{Barres de Régulation (ou de Pilotage)} :  
    Ont un "poids" (valeur d'antiréactivité) relativement faible. Elles sont conçues pour se déplacer rapidement et continuellement. 
    Leur rôle est de compenser les petites fluctuations de puissance pour maintenir le réacteur au niveau attendu.

    \item \emph{Barres de Compensation (ou "Shim")} : 
    Ont un poids antiréactif beaucoup plus important. Elles sont déplacées très lentement pour compenser les grands 
    changements de réactivité à long terme, comme l'usure du combustible ou l'empoisonnement des barres.
    
    \item \emph{Barres d'Arrêt d'Urgence (SCRAM)} :
    représentent la solution de dernier recours. Elles ont un poids antiréactif très important et sont 
    conçues pour s'insérer extrêmement rapidement. Leur rôle principal est de stopper la réaction en chaîne de manière 
    quasi instantanée en cas d'anomalie grave.
\end{itemize}

Pour des raisons pratiques, nous choisirons d'implémenter uniquement les barres de régulation ainsi que les barres SCRAM.
En effet, les barres de compensation sont utilisées sur des temps très long et pour des tâches qui dépassent notre simulation.


\subsubsection{Modélisation de l'antiréactivité}

Pour simuler l'impact des barres de pilotage sur la réactivité du cœur, nous utilisons un modèle global
\footnote{L'implémentation d'un modèle spatial, prenant en compte la position des barres dans le réacteur, n'était pas approprié pour une modélisation de cette ampleur.}.

Le défi majeur de l'implémentation de cette fonctionnalité repose sur le fait que l'efficacité des barres n'est pas linéaire par rapport à son insertion : 
elle dépend du flux de neutrons présent à la hauteur où se trouve la pointe de la barre.
Dans un réacteur homogène, la distribution spatiale du flux de neutrons \(\phi(z)\) selon l'axe vertical suit une forme sinusoïdale, 
étant maximale au centre du cœur et quasi-nulle aux extrémités à cause des fuites.

L'efficacité différentielle d'une barre\footnote{Cela correspond à l'antiréactivité ajoutée par centimètre d'insertion.} est proportionnelle au flux neutronique local. 
L'efficacité totale \(\rho(z)\) à une profondeur \(z\) est donc l'intégrale de ce flux. Or l'intégrale d'une fonction sinus/cosinus donne une forme caractéristique appelée \textbf{courbe en S}.

Nous approcherons cette courbe par la formule suivante, où \(z \in [0,1]\) représente la fraction d'insertion (\(0=\text{sortie}, 1=\text{insérée}\)) :

    \begin{equation}
        \rho(z) = \rho_{\text{total}} \times \frac{1}{2} \left( 1 - \cos(\pi z) \right)
    \end{equation}

Dans notre simulation, cette valeur \(\rho(z)\) (exprimée en pcm\footnote{Unité de réactivité, abréviation de "pour cent mille".})
est convertie en un facteur multiplicatif appliqués aux probabilités de fission \(f\) et d'absorption \(a\) du modèle stochastique.
Etant donné que les barres de pilotage n'ont d'effet que sur les neutrons les plus lents ({thermiques voir \ref{subsec:neutron-type}}\footnote{Il est nécessaire de nuancer nos propos. 
Les neutrons épithermiques sont également capturés via un système de résonance par effet Dopler avec des barres 
spéciales. Mais pour des besoins de simplification, nous avons choisi de rendre uniquement les neutrons 
\textit{thermiques} absorbables par le système de contrôle.}), les probabilités concernant les autres types restent 
inchangées.

    \begin{figure}[H]
        \centering
        \includegraphics[scale=1]{images/integral_control_rod_worth_curve.jpg}
        \caption{Courbe en S représentant l'antiréactivité des barres de pilotage.}
        \label{fig:s_curve}
    \end{figure}


\subsection{Modèle Thermique et Loi de Newton}

La température du réacteur est une variable d'état résultant d'un bilan énergétique. 
Pour la calculer, nous appliquons le \textbf{Premier Principe de la Thermodynnamique}\textsuperscript{\parencite{pp-thermodynamique}} : pour un système fermé, la variation de son énergie interne \((U)\) au cour du temps est égale à la somme des puissances thermiques reçues et perdues, moins le travail mécanique effectué par le système.

    \begin{equation}
        \frac{dU}{dt} = \dot{Q} - \dot{W}
    \end{equation}

Où :

\begin{itemize}
    \item \(\dot{Q}\) : Le flux thermique net (\(W\)).
    \item \(\dot{W}\) : La puissance mécanique fournie par le système (\(W\)).
\end{itemize}

Ici, le coeur du réacteur ne fournit aucun travail mécanique. Le flux thermique net \(\dot{Q}\) se décomposant en deux termes : la puissance générée par la fission (\(P_{int}\)) et la puissance évacuée par le refroidissement (\(P_{out}\)). Nous pouvons reformuler le principe énoncé plus haut de la façon suivante :
la variation d'énergie interne du système est égale à la différence entre la puissance produite et la puissance évacuée.

    \begin{equation}
        \frac{dU}{dt} = P_{\text{in}}(t) - P_{\text{out}}(t)^\text{\parencite{capacite-thermique}}
    \end{equation}

Or $ P_{\text{in}}(t)$ est la puissance générée par la fission dans le réacteur et $  P_{\text{out}}(t)$ 
correspond à celle perdue par reffroidissement. 
De plus, sachant que\footnote{Cette égalité vient de la définition de la capacité thermique\textsuperscript{\parencite{capacite-thermique}} d'un corps. 
Elle énonce que pour un système incompressible, la variation d'énergie interne est proportionnelle à 
la variation de température. Le coefficient de proportionnalité est la \textbf{capacité thermique} du système, 
notée \(C\).} \(dU = C \cdot dT\) (où \(C\) est la capacité thermique totale du cœur 
en \(J \cdot K^{-1}\)), l'équation d'évolution de la température s'écrit donc : 

    \begin{align}
        & C \cdot \frac{dT(t)}{dt} = P_{\text{fission}}(t) - P_{\text{refroidissement}}(t) \\ 
        \iff & \frac{dT(t)}{dt} = \frac{1}{C} \left( P_{\text{fission}}(t) - P_{\text{refroidissement}}(t) \right) 
    \end{align}

La capacité thermique $C$ du modèle sera une valeur fixée à son initialisation. 

La puissance entrant dans le système, \(P_{\text{fission}}\), est directement proportionnelle au 
nombre de fissions par seconde simulées par notre modèle de neutrons. L'énergie perdue par reffroidissement est, 
quand à elle, plus difficile à calculer. 

\subsubsection{Évacuation de Chaleur (\(P_{\text{out}}\)) - Loi de Newton}

Nous allons considérer que l'échange d'énergie thermique se fait uniquement entre le noyau et le sytème 
de reffroidissement du réacteur (généralement de l'eau). 
Ainsi, pour modéliser cet échange, nous utilisons la \textbf{Loi de Refroidissement de Newton}\textsuperscript{\parencite{loi-refroidissement-newton}}.
Elle énonce que le taux de perte de chaleur d'un corps est proportionnel à la différence 
de température entre le corps et le milieu environnant :

\begin{equation}
    P_{\text{out}}(t) = h \cdot (T(t) - T_{\text{eau}})
\end{equation}

Où :
\begin{itemize}
    \item \(h\) : Le coefficient global de transfert thermique\footnote{Il s'agit du coefficient de 
        refroidissement et dépend de la surface de contact ainsi que du modérateur utilisé. Il est défini 
        dans notre code par : \(cooling\_coef = thermic\_capacity * \tau\,\text{avec}\,\tau=0.05\).} 
        en \(W \cdot K^{-1}\).
    \item \(T(t)\) : La température du réacteur à l'instant \(t\).
    \item \(T_{\text{eau}}\) : La température du fluide de refroidissement que nous fixerons à \(300K\)\footnote{Cette 
        valeur choisit arbitrairement correspond à environ \(26^\circ C\), elle doit être comprise 
        entre \(0^\circ C\) et \(30^\circ C\)} dans notre modèle.
\end{itemize}

\subsubsection{Paramétrage de l'Inertie Thermique}

En combinant les équations précédentes, l'évolution de la température du réacteur est régie par l'équation différentielle :

    \begin{equation}
        \frac{dT}{dt} = \frac{P_{\text{fission}}}{C} - \frac{h}{C} (T - T_{\text{eau}})
    \end{equation}

Le terme \(\frac{h}{C}\) représente l'inverse de la constante de temps thermique du système, notée \(\tau_{\text{th}}\). 
Elle caractérise la vitesse à laquelle le réacteur se refroidit naturellement. Dans notre code, nous avons fixé empiriquement ce ratio à :

\[
    \frac{h}{C} = 0.05 \, s^{-1}
\]

Cela correspond à une constante de temps \(\tau_{\text{th}} = \frac{1}{0.05} = 20\) secondes. Ce choix nous permet 
d'obtenir une simulation viable où la température réagit aux variations de puissance de façon adaptée où 
le système de refroidissement du réacteur est très performant. 
Ainsi, en suivant cette loi, la température d'un corps dont la température est supérieure à son environnement 
suit une courbe similaire à celle-ci dessous\footnote{Aussi, plus la différence de température est grande plus elle va diminuer rapidement jusqu'à l'état d'équilibre.} :

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.4]{images/newton_law.png}
    \caption{Graphe de refroidissement d'un corps par la loi de Newton.}
    \label{fig:newton_law}
\end{figure}

% ==================================================================================================================================
% Modélisation 

\section{Simulation}

\subsection{Objectif et principe}

L'objectif est maintenant de modéliser toutes les notions vues précédement. 
Nous étudierons l'évolution d'une population de neutrons dans un environnement représentant
le réacteur. L'évolution de cette population dépendra de différents paramètres donnés à l'initialisation 
ou grâce au modérateur utilisé. 
Deux version du modèle existent. La première, expérimentale est très simple. La seconde, celle que nous 
détaillerons ici est un système à base d'agents (les neutrons) et implémente plus de mécanismes. 

\subsection{Représentation}

Le système est donc composé de 4 éléments : les neutrons, le réacteur le modérateur ainsi que les barres de contrôle. Chacun est représenté de façon 
individuelle par un objet en Python. 

\medskip 

Premièrement, une classe \texttt{Neutron} a été créé pour représenter individuellement chaque individu de la population. 
Elle permet d'attribuer des valeurs de vitesse, position, type au autres à chaque neutron présent dans le réacteur. 
Différentes méthodes existent donc pour mettre à jour ces valeurs, même si la plupart des calculs sont effectués dans 
la classe \texttt{ReactorV2}. 

L'espace de vie des neutrons est, quand à lui, représenté par une grille 2D (un tableau en Python) sauvegardé 
dans la classe \texttt{ReactorV2}. Un paramètre de celle-ci permet de la rendre torique. 

Le modérateur est lui aussi modélisé par une classe appelée \texttt{Moderator}. Un modérateur 
est simplement défini par ses probabilités d'absorption, de diffusion, de fission des neutrons ainsi 
que par des propriétés de changement d'état de ceux-ci. 
L'ensemble des modérateurs possibles est stocké dans un dictionnaire de la classe \texttt{Reactor}. 
Le modérateur choisi influcence directement l'évolution de la population de neutrons ainsi que 
leur comportement au cours du temps. 

Les barres de contrôle sont instanciées par la classe \texttt{controlRod} contenant les paramètres de chaque type de barre
ainsi que différentes fonctions utiles à sa gestion. 

Enfin, le réacteur est simulé par la classe \texttt{ReactorV2}. Outre des paramètres classiques tels que sa taille, 
le nombre d'itérations de la simulation ou autre, celle-ci stocke un dictionnaire de neutrons représentant l'état 
du réacteur à un moment donné. Pour conserver l'historique de son état, on stocke la suite de ces dictionnaires dans 
une liste \texttt{history}. 

\medskip

Pour conclure sur cette partie, le coeur de la simulation se situe dans la classe \texttt{ReactorV2}. Chaque 
ajout de fonctionnalité (modérateur, neutron, etc...) est représentée par une classe ajoutée en paramètre. 

\subsection{Dynamique}

Penchons nous maintenant sur la dynamique du modèle. Nous allons ici détailler le cycle d'une génération de neutrons. 
Tout commence par l'initialisation du modèle : on choisit de positionner un certain nombre de neutrons 
sur la grille du réacteur (selon une loi Uniforme, Normale ou centrée). 

À chaque pas de temps, on considère chaque neutron indépendament des autres. Si l'on a spécifié un modérateur lors de 
l'initialisation du modèle, on choisit une action pour ce neutron par un tirage aléatoire dépendant des 
différentes probabilités données par le modérateur. Si aucun modérateur n'est spécifié, on utilise les probabilités 
données par défaut. Ainsi, un neutron peut effectuer une seule action à chaque pas de temps : 
\begin{itemize} 
    \item \textbf{Diffusion} : le neutron continue à se déplacer dans le milieu en tirant aléatoirement une direction et 
    une distance qui détermineront sa position au prochain pas de temps. 
    \item \textbf{Absorption} : le neutron est absorbé par le modérateur, il disparaît du modèle. 
    \item \textbf{Fission} : le neutron rencontre un isotope et produit une réaction de fusion. 
    Il disparaît donc et un nombre aléatoire (suivant une loi de Poisson) de nouveaux neutrons est produit 
    sur la même case. À noter que seuls les neutrons thermiques peuvent réagir (voir \ref{subsec:comportement-neutrons}). 
\end{itemize}

\subsection{Les neutrons}\label{subsec:comportement-neutrons}

Nous avons modélisé différents types de neutrons dans le réacteur pour coller au plus à la réalité.
En effet, dans un réacteur à fission, toutes les particules ne se déplacent pas à la même vitesse. Les neutrons nouvellement 
produits par une réaction de fission sont en effet très rapides et ne sont donc pas en phase avec les noyaux 
lourds restant pour réagir. Le modérateur sert donc à ralentir ces neutrons. 

Ainsi, pour plus de flexibilité, les neutrons ont étés représentés indépendament les uns des autres grâce 
au modèles d'agent, implémenté par la classe \texttt{Neutron}.
Chaque neutron possède donc différents attributs : 
\begin{itemize}
    \item Sa position \texttt{self.x} et \texttt{self.y} qui représentent ses coordonnées dans le réacteur.
    \item Un identifiant unique \texttt{self.id}.
    \item Un type \texttt{self.type} qui peut être \texttt{fast}, \texttt{epithermal} ou \texttt{termal}.
    Chaque type de neutron a des comportements différents (voir \ref{subsec:neutron-type}). 
    \item Une vitesse \texttt{self.speed} : très importante au départ, elle diminue au fur et à mesure 
    de la durée de vie du neutron selon le type de modérateur.
    \item Une trajectore \texttt{self.traj}. 
    \item Une durée de vie \texttt{self.age} correspondant au nombre d'itérations effectué.
\end{itemize}

Le coeur du processus d'évolution d'un neutron est encodé par la méthode \texttt{self.evolve}.
À chaque itération du réacteur, on recalcule le type du neutron selon les probabilités 
de transition spécifiées par le modérateur. 

La méthode \texttt{self.diffuse} calcule, quand à elle, les nouvelles coordonnées du neutron si celui-ci 
doit se déplacer. Un neutrons se déplace de façon uniforme dans un cercle définit autour de lui 
de rayon \texttt{self.max\_speed}.

\subsection{La gestion de la réaction : Les barres de contrôle}\label{subsec:comportement-barres}

D'un point de vue informatique, ce système repose sur l'interaction de trois composants distincts : 
la modélisation physique de la barre, l'automate de pilotage ainsi que la boucle de rétroaction sur les neutrons.

\subsubsection{La classe \texttt{ControlRod}}

Chaque barre est un agent indépendant défini par ses caractéristiques physiques et son état dynamique :
\begin{itemize}
    \item \textbf{Attributs statiques :} Un type définissant son poids neutronique total et sa vitesse maximale de déplacement (\(\% \cdot s^{-1}\)).
    \item \textbf{Attributs dynamiques :} Sa position actuelle (\(\texttt{position\_percent} \in [0, 100]\)) et sa consigne (\texttt{target\_position}).
    \item \textbf{Méthode \texttt{step(dt)} :} Met à jour la position de la barre à chaque pas de temps pour rejoindre sa consigne, en respectant sa vitesse maximale.
    \item \textbf{Méthode \texttt{get\_reactivity\_pcm()} :} Calcule l'efficacité instantanée de la barre selon la courbe en S, convertissant la position mécanique en antiréactivité neutronique.
\end{itemize}

\subsubsection{Boucle de Contrôle-Commande}

À chaque itération de la simulation, la gestion des barres suit le cycle suivant :

\begin{enumerate}
    \item \textbf{Mesure :}
    Le réacteur calcule sa puissance instantanée \(P(t)\) à partir du nombre de fissions observées. Elle est ensuite normalisée en un pourcentage de la puissance nominale (\(P_{\%}\)).
    \item \textbf{Sécurité (Fonction \texttt{check\_emergency\_scram}) :}
    On vérifie si \(P_{\%} > P_{\text{seuil}}\).
    Si le seuil est dépassé, le mode SCRAM est enclenché : le pilote automatique est désactivé et toutes les barres reçoivent l'ordre de s'insérer à 100\%.
    \item \textbf{Régulation (Fonction \texttt{update\_automatic\_control\_rods}) :}
    Si le SCRAM n'est pas activé, le régulateur PI\ref{algo-pi} calcule l'erreur de puissance.
    Il détermine une nouvelle position cible pour les barres de régulation afin d'annuler cette erreur :
    \item \textbf{Action Physique :}
    Les barres se déplacent mécaniquement vers leur nouvelle cible.
    L'antiréactivité totale est calculée et convertie en un facteur correctif appliqué aux probabilités de fission et d'absorption pour le pas de temps suivant.
\end{enumerate}

\subsubsection{Algorithme de Pilotage : Le Régulateur PI}\label{algo-pi}

Pour ajuster automatiquement la position des barres de régulation, nous avons implémenté un correcteur 
\textbf{Proportionnel-Intégral (PI)}\textsuperscript{\parencite{reg-pi}}. C'est un mécanisme de rétroaction : 
le système observe l'écart entre la puissance réelle et la puissance voulue pour corriger sa commande en temps réel.
L'objectif est d'annuler l'\textbf{erreur} \(\varepsilon(t)\), définie par :

    \begin{equation}
        \varepsilon(t) = P_{\text{consigne}} - P_{\text{réelle}}(t)
    \end{equation}

La nouvelle position cible est la somme de deux termes complémentaires :

    \begin{equation}
        \text{Position}(t) = \text{Base} + \underbrace{K_p \cdot \varepsilon(t)}_{\text{Terme Proportionnel}} + \underbrace{K_i \cdot \int_{0}^{t} \varepsilon(\tau) d\tau}_{\text{Terme Intégral}}
    \end{equation}

\begin{itemize}
    \item \textbf{Le Terme Proportionnel (\(P : K_p\)) :} Il assure la réactivité du système. La correction 
        est directement proportionnelle à l'erreur instantanée. Si l'écart de puissance est grand, la barre bouge vite.
    \item \textbf{Le Terme Intégral (\(I : K_i\)) :} Il assure la précision. Il correspond à la somme des 
        erreurs passées. Si une petite erreur persiste, le terme intégral va augmenter progressivement jusqu'à 
        forcer la barre à bouger pour éliminer totalement l'écart.
\end{itemize}

Dans notre simulation en temps discret, l'intégrale mathématique est approximée par une somme cumulée à chaque pas de temps :
    \[ \int \varepsilon \, dt \approx \sum \varepsilon \cdot dt \]

% ==================================================================================================================================
% Études statistiques 

\section{Études Statistiques}

\subsection{Paramètres de l'étude}

comment on a fait les fichiers css, quelles données ils contiennent etc

\subsection{Conjectures}

qu'est ce qu'on compte montrer
ligne directrice

\subsection{Etude univariée}

étude simple des variable permettant de montrer que le reacteur fonctionne "correctement"
temperature power barres de controles etc\\
+qu'est ce qu'on peut en déduire concernant nos conjectures\\

position des neutrons dans le reacteur


\subsection{Etude bivariée}

power en fonction de la temperature/ nb neutrons etc\\
profondeur des barres en fonction du power+ test de khi2 pour osbserver la corélation assez forte (on en sort une limite : par moment c'est pas encore tout à fait exact)



% ==================================================================================================================================
% Conclusion

\newpage
\section{Conclusion}

résumé des résultats obtenus

apports technique et humain

extensions possibles
limites


% ==================================================================================================================================
% Annexes 1

\newpage
\section*{Annexe 1 - Le premier régulateur PI}
\addcontentsline{toc}{section}{Annexe 1 - Le premier régulateur PI}

L'ancêtre du régulateur proprotionnel intégrable qui régit actuellement le monde de l'industrie vient de l'ingénieur écossais James Watt\textsuperscript{\parencite{james-watt}}.
Grâce à son invention : le \textit{régulateur à boules}, il est considéré comme l'un des inventeurs de la machine à vapeur.

\paragraph{Le principe.}    Deux boules en métal tournent entrainées par un moteur. Plus le moteur va vite, plus la force centrifuge écarte les boules.
En s'écartant, elles tirent sur un levier qui ferme l'arrivée de vapeur.
Il s'agit de l'ancêtre du \textit{régulateur proprotionnel (P)} que nous utilisons dans notre simulation. Si la vitesse augementait (erreur), la vapeur diminuait instantanément et faisait donc baisser les boules.

\paragraph{Le problème.}    Ce modèle souffrait de ce que l'on appelle l'erreur statique La machine manquait de précision et ne tenait jamais exactement la position souhaitée.
C'est pour cette raison que le terme \textit{intégral (I)} a été inventé plus tard.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.3]{images/watt_regulator.jpg}
    \caption{Ancêtre du régulateur PI mis au point par James Watt.}
    \label{fig:watt_regulator}
\end{figure}

% ==================================================================================================================================
% Annexes 2

\newpage
\section*{Annexe 2 - Qu'en est-il de notre système d'urgence européen ?\textsuperscript{\parencite{control-rod-europe}}}
\addcontentsline{toc}{section}{Annexe 2 - Qu'en est-il de notre système d'urgence européen ?}

En Europe, et particulièrement en France, le type de réacteur dominant est le \emph{Réacteur à Eau Pressurisée} (REP).\\
Dans un REP, le contrôle de la réactivité est géré par deux systèmes complémentaires :
\begin{enumerate}
    \item \emph{Le Bore Soluble :} C'est un "poison" liquide qui permet de compenser les ajustements lents.
    \item \emph{Les Barres Mécaniques :} Elles sont utilisées pour la régulation et l'arrêt d'urgence (SCRAM).
\end{enumerate}

Le mécanisme de SCRAM sur un REP est un exemple de \emph{sécurité passive} : les barres d'arrêt sont maintenues en position 
haute par des électroaimants. En cas d'arrêt d'urgence, le courant est coupé, les aimants lâchent les barres, qui tombent alors par
simple gravité dans le cœur, assurant l'arrêt du réacteur même en cas de panne de courant totale. 
Nous nous sommes basé sur ce système pour implémenter notre fonctionnalité permettant une auto-régulation de la puissance en fonction de celle souhaitée.


% ==================================================================================================================================
% Biblio


\newpage 
\printbibliography

\end{document}